<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <script type="application/javascript" src="../chrome-polyfill.js"></script>
  <title>Settings &mdash; Save In</title>
  <link href="style.css" rel="stylesheet">
</head>

<body id="settings-page">
  <div>
    <a class="open-settings-in-window" href="options.html" target="_blank">Popout settings page</a>
    &middot;
    <a class="external" href="https://github.com/gyng/save-in/">GitHub</a>
    &middot;
    <a class="external" href="https://github.com/gyng/save-in/blob/master/CHANGELOG.md">Changelog</a>
  </div>

  <form id="options">
    <h2 id="section-downloads">Downloads</h2>
    <h3 class="popout link" data-popout-for="variablelist.html">ðŸ““ Variable list</h3>

    <label class="column">
      <h3>Directories
        <a href="#" class="help learn-more" data-help-for="help-paths">guide</a>
      </h3>
      <p>One path per line, relative to the default download directory.
        <code>.</code> downloads to the default download directory.</p>
      <p>A symlink is needed to save outside the default download directory (see guide).</p>
      <div class="help-text" id="help-paths">
        <h4>Creating context menu items</h4>
        <div class="demo-box" style="margin-top: 12px; align-items: flex-start;">
          <div class="demo-code left ">
            <pre class="click-to-copy">.
i/dogs
i/cats
---
v/cats
:date:/:day:/foo
</pre>
            <div class="caption">Settings</div>
          </div>
          <div class="demo-arrow">âž¡</div>

          <div class="demo-code">
            <pre>~/downloads/
~/downloads/i/dogs
~/downloads/i/cats
---
~/downloads/v/cats
~/downloads/2000-01-01/01/foo
</pre>
            <div class="caption">Default download dir
              <code>~/downloads</code>
            </div>
          </div>

          <div class="demo-arrow">âž¡</div>

          <pre class="demo-pic" style="background-image: url(i/menu-items.png)">






</pre>
        </div>

        <p>Saving a picture
          <code>cat.jpg</code> into
          <code>i/cats</code> will save it as
          <code>~/downloads/i/cats/cat.jpg</code>.</p>

        <p>Invalid paths (
          <code>..</code> and
          <code>/</code>) are ignored. Files and directories with leading dots (
          <code>foo/.hidden</code>) are considered invalid by Firefox and Chrome.</p>

        <h4>Saving outside the default download directory</h4>
        <p>The WebExtensions API does not allow files to be saved outside of the default download directory. A
          <a class="external" href="https://en.wikipedia.org/wiki/Symbolic_link" target="_blank">symlink</a> inside the default download directory can be used to get around this limitation.
        </p>

        <br>
        <a class="external" href="https://technet.microsoft.com/en-us/library/cc753194(v=ws.11).aspx" target="_blank">
          Windows
        </a>
        <pre class="click-to-copy">mklink /D C:\path\to\symlink D:\path\to\actual</pre>

        <a class="external" href="http://manpages.ubuntu.com/manpages/xenial/man1/ln.1.html" target="_blank">
          macOS/Unix
        </a>
        <pre class="click-to-copy">ln -s /path/to/actual /path/to/symlink</pre>

        <p>Make sure the target directories actually exist, or the extension will silently fail to download.</p>
      </div>
      <textarea type="textarea" id="paths" rows=10 placeholder="." spellcheck="false"></textarea>
    </label>

    <h3>Behavior</h3>

    <label>
      <input type="checkbox" id="links" /> Enable saving of links. Prefers sources if available.
    </label>

    <label>
      <input type="checkbox" id="selection" /> Enable saving of selected text with a
      <code>.selection.txt</code> extension
    </label>

    <label>
      <input type="checkbox" id="page" /> Enable saving of the current page
      <div class="caption caption-line">Does not save external resources</div>
    </label>

    <label>
      <input type="checkbox" id="prompt" /> Open a save file dialog when saving
    </label>

    <label>
      <input type="checkbox" id="promptIfNoExtension" /> Open a save file dialog if filename has no extension
    </label>

    <label>
      <select disabled class="chrome-enabled" id="conflictAction">
        <option value="uniquify">Uniquify</option>
        <option value="overwrite">Overwrite</option>
        <option value="prompt">Prompt</option>
      </select>
      when a duplicate filename is encountered
      <span class="badge">Chrome</span>
    </label>

    <label>
      Replace invalid characters with
      <input type="text" id="replacementChar" placeholder="delete" style="font-family: monospace;" />
      <div class="caption caption-line">Leave blank to delete. Invalid replacement characters are ignored.</div>
    </label>
    <hr>



    <label class="column">
      <h2>Dynamic downloads (advanced)</h2>
      <div style="display: flex; justify-content: flex-start; align-items: center;">
        <h3 style="width: auto;" class="popout link" data-popout-for="variablelist.html">ðŸ““ Variable list</h3>
        &nbsp;&nbsp;&nbsp;
        <h3 style="width: auto;" class="popout link" data-popout-for="clauselist.html">ðŸ““ Clause list</h3>
      </div>

      <h3>Rename and route downloads
        <a href="#" class="help learn-more" data-help-for="help-filenames">guide</a>
      </h3>
      <div class="help-text" id="help-clause-list">
        <p>Clauses are only used in rule definitions for routing and renaming to determine if a download should be renamed or
          routed.
        </p>
        <h3>Output and others</h3>
        <table class="box">
          <tr>
            <td>
              <code class="click-to-copy">into:</code>
            </td>
            <td>
              <code>:fileext:/foo</code>
            </td>
            <td>
              <span class="badge warning">Required</span> Routes downloads to, or rewrites download filenames into the given pattern</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">capture:</code>
            </td>
            <td>
              <code>pageurl</code>
            </td>
            <td>
              <span class="badge">Optional</span> Selects the matcher for regex capture group variables (
              <code class="click-to-copy">:$1:</code>,
              <code class="click-to-copy">:$2:</code>&hellip;)</td>
          </tr>
        </table>

        <h3>Matchers</h3>
        Matcher clauses use
        <a class="external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions" target="_blank">regular expression</a> strings.

        <table class="box">
          <tr>
            <td>
              <code class="click-to-copy">fileext:</code>
            </td>
            <td>
              <code>jpg</code>
            </td>
            <td>Matches the naive file extension</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">filename:</code>
            </td>
            <td>
              <code>actual_filename.jpg</code>
            </td>
            <td>Matches the final filename</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">frameurl:</code>
            </td>
            <td>
              <code>http://www.google.com</code>
            </td>
            <td>Matches the URL of the current frame</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">linktext:</code>
            </td>
            <td>
              <code>Click here to download</code>
            </td>
            <td>
              <span class="badge">Firefox</span> Matches the link text or element
              <code>title</code> attribute</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">mediatype:</code>
            </td>
            <td>
              <code>image</code>
            </td>
            <td>Matches the media type:
              <code>audio</code>,
              <code>video</code>, or
              <code>image</code>
            </td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">naivefilename:</code>
            </td>
            <td>
              <code>cat.jpg</code>
            </td>
            <td>Matches the naive filename</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">pagedomain:</code>
            </td>
            <td>
              <code>xyz.com</code>
            </td>
            <td>Matches the page hostname</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">pagetitle:</code>
            </td>
            <td>
              <code>Welcome to my page!</code>
            </td>
            <td>Matches the current page title</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">pageurl:</code>
            </td>
            <td>
              <code>http://www.google.com</code>
            </td>
            <td>Matches the current page URL</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">selectiontext:</code>
            </td>
            <td>
              <code>"X-Cops" is the twelfth</code>
            </td>
            <td>Matches the selection text</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">sourcedomain:</code>
            </td>
            <td>
              <code>cdn.xyz.com</code>
            </td>
            <td>Matches the source hostname for media</td>
          </tr>
          <tr>
            <td>
              <code class="click-to-copy">sourceurl:</code>
            </td>
            <td>
              <code>http://cdn.xyz.com/pic.jpg</code>
            </td>
            <td>Matches the source URL for media</td>
          </tr>
        </table>
      </div>

      <p>Automate routing of downloads or renaming of files. Separate multiple rules with an empty line. See the guide for more
        details.</p>
      <p>The following example moves all
        <code>.gif</code> files into the
        <code>gif</code> subdirectory and renames the moved files to a timestamp.</p>

      <pre class="click-to-copy">
fileext: gif
into: gif/:unixdate:.:fileext:</pre>

      <p>Routing is relative to the selected menu item, so if you download a cat gif using the
        <code>images</code> context menu, the above example will save the cat as
        <code>./images/gif/946684800.gif</code>. See the clause list and the guide for more details.
      </p>

      <p class="chrome-only">CHROME USERS: Special characters in the filename (eg.
        <code>:</code> or
        <code>/</code>) are pre-replaced with the character
        <code>-</code> by Chrome. Match against
        <code>-</code> instead of these special characters. For example, use
        <code>(.*)-large</code> to match filenames instead of
        <code>(.*):large</code>.
      </p>
      </div>

      <div class="help-text" id="help-filenames">
        <h4>Rewrite filenames</h4>
        <p>
          Match downloads against regex. If all regex match, rewrite the filename according to
          <code class="click-to-copy">into:</code>. Matcher clauses use
          <a class="external" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_Expressions">regular expression</a> strings</p>

        <p>This renames all gif files to a unix timestamp</p>
        <div class="demo-box">
          <pre class="demo-code left click-to-copy">
fileext: gif
into: :unixtimestamp:.:fileext:</pre>

          <div class="demo-arrow">=</div>

          <pre class="demo-code right">
cat.gif âž¡ 1512136516.gif
 </pre>
        </div>

        <p>This advanced example renames downloads based off captured regex groups &mdash; the stuff inside
          <code>()</code>.
          <code class="click-to-copy">capture: filename</code> selects the filename's capture groups, and finally
          <code class="click-to-copy">into:</code> renames the files based off them using
          <code class="click-to-copy">:$1:</code> for the first one
          <code>(.*)</code>, and
          <code class="click-to-copy">:$2:</code> for the second one
          <code>(tar|gz)</code>.

          <div class="demo-box">
            <pre class="demo-code left click-to-copy">
filename: (.*)\.(tar|gz)
capture: filename
into: :$1:-:$2:.:fileext:</pre>

            <div class="demo-arrow">=</div>

            <pre class="demo-code right">
ubuntu.tar âž¡ ubuntu-tar.tar
debian.gz  âž¡ debian-gz.gz
ubuntu.zip âœ˜ (no match)</pre>
          </div>

          <h4>Route downloads into directories</h4>
          <p>Extend a filename rewrite rule to include
            <code>/</code> in the
            <code class="click-to-copy">into:</code> clause. The route will be relative to the chosen directory. Note that you need to supply the
            <code class="click-to-copy">:filename:</code> variable.</p>

          <div class="demo-box">
            <pre class="demo-code left click-to-copy">
mediatype: audio
sourceurl: foo.com
into: music/:date:/:filename:</pre>

            <div class="demo-arrow">=</div>

            <pre class="demo-code right">
foo.com/a.mp3 âž¡ music/2000-01-01/a.mp3
bar.com/a.mp3 âœ˜ (no match)
foo.com/b.avi âœ˜ (no match)</pre>
          </div>

          <a class="external" href="https://github.com/gyng/save-in/wiki/Filename-rewrite">Short list of useful rules</a>
      </div>
      </div>
      </div>
      <textarea type="textarea" id="filenamePatterns" rows=7 placeholder="Optional" spellcheck="false" data-errors-in
        "error-filenamePatterns"></textarea>
      <div class="error-notification" id="error-filenamePatterns">errors</div>
    </label>

    <label>
      <input type="checkbox" id="routeFailurePrompt" /> Open a save file dialog if no rules match
    </label>

    <label>
      <input type="checkbox" id="routeExclusive" /> Exclusively use routing and renaming rules
      <div class="caption caption-line">Disables submenu for two-click downloads</div>
    </label>

    <hr>

    <h2 id="section-notifications">Notifications</h2>
    <label>
      <input type="checkbox" id="notifyOnSuccess" /> Show notification on successful download
    </label>

    <label>
      <input type="checkbox" id="notifyOnFailure" /> Show notification on failed download
    </label>

    <label>
      <input type="checkbox" id="notifyOnRuleMatch" /> Show notification on a rule match
    </label>

    <label>
      Close notifications early after
      <input type="number" id="notifyDuration" min="0" />ms
      <div class="caption caption-line">1s = 1000ms. Will not extend beyond OS/browser notification duration.</div>
    </label>

    <hr />

    <h2 id="section-save-as-shortcuts">Save as shortcuts</h2>
    <label>
      Save shortcuts as
      <select id="shortcutType">
        <option value="HTML_REDIRECT">HTML redirect</option>
        <option value="MAC">Mac .url</option>
        <option value="WINDOWS">Windows .url</option>
        <option value="FREEDESKTOP">Freedesktop .desktop</option>
      </select>
    </label>

    <label>
      <input type="checkbox" id="shortcutMedia" /> Save media as shortcuts instead
    </label>

    <label>
      <input type="checkbox" id="shortcutLink" /> Save links as shortcuts instead
    </label>

    <label>
      <input type="checkbox" id="shortcutPage" /> Save pages as shortcuts instead
    </label>

    <hr>

    <h2 id="section-more-options">More options
      <div id="reset" class="button float-right">Restore defaults</div>
    </h2>

    <label>
      Truncate path components to
      <input type="number" id="truncateLength" min="1" /> characters
      <div class="caption caption-line">0 = no truncation</div>
    </label>

    <div id="print-debug-info" class="button">Show debug information</div>

    <label>
      <input type="checkbox" id="debug" /> Enable debug logging
    </label>
  </form>

  <script src="options.js"></script>
  <script src="clicktocopy.js"></script>
</body>

</html>